{
    "appid": "cd489149-80b1-48f2-ae0a-a9761bd1efec",
    "name": "SentinelOne",
    "description": "This app integrates with the SentinelOne Singularity platform to perform <b>prevention</b>, <b>detection</b>, <b>remediation</b>, and <b>forensic</b> endpoint management tasks.",
    "type": "endpoint",
    "product_vendor": "SentinelOne",
    "logo": "sentinelone.png",
    "logo_dark": "sentinelone_dark.png",
    "product_name": "SentinelOne",
    "python_version": "3",
    "product_version_regex": ".*",
    "publisher": "SentinelOne",
    "license": "Copyright (c) SentinelOne, 2020",
    "app_version": "2.1.0",
    "utctime_updated": "2020-11-11T20:51:43.567798Z",
    "package_name": "phantom_sentinelone",
    "main_module": "sentinelone_connector.pyc",
    "min_phantom_version": "4.8.0",
    "app_wizard_version": "1.0.0",
    "configuration": {
        "sentinelone_console_url": {
            "description": "SentinelOne Console URL",
            "data_type": "string",
            "required": true,
            "value_list": [],
            "default": "https://your-mgmt.sentinelone.net",
            "order": 0
        },
        "sentinelone_api_token": {
            "description": "SentinelOne API Token",
            "data_type": "password",
            "required": true,
            "order": 1
        }
    },
    "actions": [
        {
            "action": "test connectivity",
            "identifier": "test_connectivity",
            "description": "Validate the asset configuration for connectivity using supplied configuration",
            "verbose": "",
            "type": "test",
            "read_only": true,
            "parameters": {},
            "output": [],
            "versions": "EQ(*)"
        },
        {
            "action": "block hash",
            "identifier": "block_hash",
            "description": "Add a file hash to the global blocklist",
            "verbose": "",
            "type": "contain",
            "read_only": false,
            "undo": "unblock hash",
            "parameters": {
                "hash": {
                    "description": "Hash of file to block",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "sha1"
                    ],
                    "value_list": [],
                    "default": "",
                    "order": 0
                },
                "description": {
                    "description": "Description",
                    "data_type": "string",
                    "required": true,
                    "primary": false,
                    "value_list": [],
                    "default": "Added via Phantom",
                    "order": 1
                },
                "os_family": {
                    "description": "OS Family",
                    "data_type": "string",
                    "required": true,
                    "primary": false,
                    "value_list": [
                        "windows",
                        "osx",
                        "linux"
                    ],
                    "default": "windows",
                    "order": 2
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.hash",
                    "data_type": "string",
                    "contains": [
                        "sha1"
                    ],
                    "column_name": "hash",
                    "column_order": 0
                },
                {
                  "data_path": "action_result.parameter.description",
                  "data_type": "string"
                },

                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "column_name": "status",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.parameter.os_family",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric"
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric"
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "unblock hash",
            "identifier": "unblock_hash",
            "description": "Remove a hash from the global blocklist",
            "verbose": "",
            "type": "correct",
            "undo": "block hash",
            "read_only": false,
            "parameters": {
                "hash": {
                    "description": "Hash of file to remove from blocklist",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "sha1"
                    ],
                    "value_list": [],
                    "default": "",
                    "order": 0
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.hash",
                    "data_type": "string",
                    "contains": [
                        "sha1"
                    ],
                    "column_name": "hash",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "column_name": "status",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric"
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric"
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "quarantine device",
            "identifier": "quarantine_device",
            "description": "Quarantine an endpoint",
            "verbose": "",
            "type": "contain",
            "read_only": false,
            "parameters": {
                "ip_hostname": {
                    "description": "Hostname of endpoint to Quarantine",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "host name"
                    ],
                    "value_list": [],
                    "default": "",
                    "order": 0
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.ip_hostname",
                    "data_type": "string",
                    "contains": [
                        "host name"
                    ],
                    "column_name": "ip_hostname",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "column_name": "status",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric"
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric"
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "unquarantine device",
            "identifier": "unquarantine_device",
            "description": "Unquarantine an endpoint",
            "verbose": "",
            "type": "correct",
            "read_only": false,
            "parameters": {
                "ip_hostname": {
                    "description": "Hostname of endpoint to Unquarantine",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "host name"
                    ],
                    "value_list": [],
                    "default": "",
                    "order": 0
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.ip_hostname",
                    "data_type": "string",
                    "contains": [
                        "host name"
                    ],
                    "column_name": "ip_hostname",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "column_name": "status",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric"
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric"
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "mitigate threat",
            "identifier": "mitigate_threat",
            "description": "Mitigate an identified threat",
            "verbose": "Mitigate threat such as <b>kill</b>, <b>quarantine</b>, <b>remediate</b>, or <b>rollback</b>",
            "type": "correct",
            "read_only": false,
            "parameters": {
                "s1_threat_id": {
                    "description": "The threat ID",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": ["s1_threat_id"],
                    "value_list": [],
                    "default": "",
                    "order": 0
                },
                "action": {
                    "description": "Allowed values include: kill, quarantine, remediate, rollback and disconnectFromNetwork",
                    "data_type": "string",
                    "required": true,
                    "primary": false,
                    "contains": [],
                    "value_list": ["kill", "quarantine", "remediate", "rollback", "disconnectFromNetwork"],
                    "default": "quarantine",
                    "order": 1
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.s1_threat_id",
                    "data_type": "string",
                    "contains": ["s1_threat_id"],
                    "column_name": "s1_threat_id",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.parameter.action",
                    "data_type": "string",
                    "contains": [],
                    "column_name": "action",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "column_name": "status",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric"
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric"
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "scan endpoint",
            "identifier": "scan_endpoint",
            "description": "Scan an endpoint for dormant threats",
            "verbose": "",
            "type": "investigate",
            "read_only": false,
            "parameters": {
                "ip_hostname": {
                    "description": "Hostname of endpoint to scan",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "host name",
                        "ip"
                    ],
                    "value_list": [],
                    "default": "",
                    "order": 0
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.ip_hostname",
                    "data_type": "string",
                    "contains": [
                        "host name",
                        "ip"
                    ],
                    "column_name": "ip_hostname",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "column_name": "status",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric"
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric"
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "get endpoint info",
            "identifier": "get_endpoint_info",
            "description": "Get detailed information about an endpoint/agent",
            "verbose": "",
            "type": "investigate",
            "read_only": false,
            "parameters": {
                "ip_hostname": {
                    "description": "Hostname of endpoint to get information",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "host name",
                        "ip"
                    ],
                    "value_list": [],
                    "default": "",
                    "order": 0
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.ip_hostname",
                    "data_type": "string",
                    "contains": [
                        "host name"
                    ],
                    "column_name": "ip_hostname",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data.*.data.*.agentVersion",
                    "data_type": "string",
                    "column_name": "agentVersion",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.data.*.data.*.scanStatus",
                    "data_type": "string",
                    "column_name": "scanStatus",
                    "column_order": 2,
                    "example_values": [
                        "finished"
                    ]
                },
                {
                    "data_path": "action_result.data.*.data.*.scanStartedAt",
                    "data_type": "string",
                    "column_name": "scanStartedAt",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.data.*.scanFinishedAt",
                    "data_type": "string",
                    "column_name": "scanFinishedAt",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.data.*.data.*.infected",
                    "data_type": "boolean",
                    "column_name": "infected",
                    "column_order": 5
                },
                {
                    "data_path": "action_result.data.*.data.*.isActive",
                    "data_type": "boolean",
                    "column_name": "isActive",
                    "column_order": 6
                },
                {
                    "data_path": "action_result.data.*.data.*.isUpToDate",
                    "data_type": "boolean",
                    "column_name": "isUpToDate",
                    "column_order": 7
                },
                {
                    "data_path": "action_result.data.*.data.*.updatedAt",
                    "data_type": "string",
                    "column_name": "updatedAt",
                    "column_order": 8
                },
                {
                    "data_path": "action_result.data.*.data.*.threatRebootRequired",
                    "data_type": "boolean",
                    "column_name": "threatRebootRequired",
                    "column_order": 9
                },
                {
                    "data_path": "action_result.data.*.data.*.networkStatus",
                    "data_type": "string",
                    "column_name": "networkStatus",
                    "column_order": 10
                },
                {
                    "data_path": "action_result.data.*.data.*.activeThreats",
                    "data_type": "numeric",
                    "column_name": "activeThreats",
                    "column_order": 11
                },
                {
                    "data_path": "action_result.data.*.data.*.domain",
                    "data_type": "string",
                    "column_name": "domain",
                    "column_order": 12
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric"
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric"
                }
            ],
            "render": {
                "type": "table",
                "width": 12,
                "title": "Agent Endpoint Info"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "get threat info",
            "identifier": "get_threat_info",
            "description": "Get detailed information about a threat",
            "verbose": "",
            "type": "investigate",
            "read_only": false,
            "parameters": {
                "s1_threat_id": {
                    "description": "The S1 Threat ID for a specific threat",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "s1_threat_id"
                    ],
                    "value_list": [],
                    "default": "",
                    "order": 0
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.s1_threat_id",
                    "data_type": "string",
                    "contains": [
                        "s1_threat_id"
                    ],
                    "column_name": "s1_threat_id",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data.*.data.*.threatInfo.mitigationStatusDescription",
                    "data_type": "string",
                    "column_name": "Status",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.data.*.data.*.threatInfo.threatName",
                    "data_type": "string",
                    "column_name": "Threat Name",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data.*.data.*.threatInfo.confidenceLevel",
                    "data_type": "string",
                    "column_name": "AI Confidence Level",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.data.*.agentRealtimeInfo.agentComputerName",
                    "data_type": "string",
                    "contains": [
                        "host name"
                    ],
                    "column_name": "Endpoint",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.data.*.data.*.threatInfo.incidentStatusDescription",
                    "data_type": "string",
                    "column_name": "Incident Status",
                    "column_order": 5
                },
                {
                    "data_path": "action_result.data.*.data.*.threatInfo.analystVerdictDescription",
                    "data_type": "string",
                    "column_name": "Analyst Verdict",
                    "column_order": 6
                },
                {
                    "data_path": "action_result.data.*.data.*.threatInfo.createdAt",
                    "data_type": "string",
                    "column_name": "Reported At",
                    "column_order": 7
                },
                {
                    "data_path": "action_result.data.*.data.*.threatInfo.engines",
                    "data_type": "string",
                    "column_name": "Engines",
                    "column_order": 8
                },
                {
                    "data_path": "action_result.data.*.data.*.threatInfo.initiatedByDescription",
                    "data_type": "string",
                    "column_name": "Initiated By",
                    "column_order": 9
                },
                {
                    "data_path": "action_result.data.*.data.*.threatInfo.classification",
                    "data_type": "string",
                    "column_name": "Classification",
                    "column_order": 10
                },
                {
                    "data_path": "action_result.data.*.data.*.agentDetectionInfo.agentVersion",
                    "data_type": "string",
                    "column_name": "Agent Version on Detection",
                    "column_order": 11
                },
                {
                    "data_path": "action_result.data.*.data.*.agentRealtimeInfo.agentVersion",
                    "data_type": "string",
                    "column_name": "Realtime Agent Version",
                    "column_order": 12
                },
                {
                    "data_path": "action_result.data.*.data.*.mitigationStatus.*.action",
                    "data_type": "string",
                    "column_name": "Completed Actions",
                    "column_order": 13
                },
                {
                    "data_path": "action_result.data.*.data.*.threatInfo.pendingActions",
                    "data_type": "boolean",
                    "column_name": "Pending Actions",
                    "column_order": 14
                },
                {
                    "data_path": "action_result.data.*.data.*.threatInfo.rebootRequired",
                    "data_type": "boolean",
                    "column_name": "Reboot Required",
                    "column_order": 15
                },
                {
                    "data_path": "action_result.data.*.data.*.threatInfo.failedActions",
                    "data_type": "boolean",
                    "column_name": "Failed Actions",
                    "column_order": 16
                },
                {
                    "data_path": "action_result.data.*.data.*.agentDetectionInfo.agentMitigationMode",
                    "data_type": "string",
                    "column_name": "Policy at Detection",
                    "column_order": 17
                },
                {
                    "data_path": "action_result.data.*.data.*.threatInfo.mitigatedPreemptively",
                    "data_type": "boolean",
                    "column_name": "Mitigated Preemptively",
                    "column_order": 18
                },
                {
                    "data_path": "action_result.data.*.data.*.threatInfo.externalTicketExists",
                    "data_type": "boolean",
                    "column_name": "External Ticket",
                    "column_order": 19
                },
                {
                    "data_path": "action_result.data.*.data.*.threatInfo.sha1",
                    "data_type": "string",
                    "column_name": "Hash",
                    "column_order": 20
                },       
                {
                    "data_path": "action_result.data.*.data.*.agentRealtimeInfo.agentOsRevision",
                    "data_type": "string",
                    "column_name": "agentOsRevision",
                    "column_order": 21
                },   
                {
                    "data_path": "action_result.data.*.data.*.threatInfo.automaticallyResolved",
                    "data_type": "boolean",
                    "column_name": "automaticallyResolved",
                    "column_order": 22
                },
                {
                    "data_path": "action_result.data.*.data.*.threatInfo.detectionType",
                    "data_type": "string",
                    "column_name": "detectionType",
                    "column_order": 23
                },
                {
                    "data_path": "action_result.data.*.data.*.threatInfo.filePath",
                    "data_type": "string",
                    "column_name": "filePath",
                    "column_order": 24
                },
                {
                    "data_path": "action_result.data.*.data.*.threatInfo.maliciousProcessArguments",
                    "data_type": "string",
                    "column_name": "maliciousProcessArguments",
                    "column_order": 25
                },
                {
                    "data_path": "action_result.data.*.data.*.threatInfo.storyline",
                    "data_type": "string",
                    "column_name": "storyline",
                    "column_order": 26
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric"
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric"
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "on poll",
            "description": "Callback action for the on_poll ingest functionality.",
            "type": "ingest",
            "identifier": "on_poll",
            "read_only": true,
            "parameters": {
              "container_id": {
                "data_type": "string",
                "order": 0,
                "description": "Container IDs to limit the ingestion to.",
                "allow_list": true
              },
              "start_time": {
                "data_type": "numeric",
                "order": 1,
                "description": "Start of time range, in epoch time (milliseconds)",
                "verbose": "If not specified, the default is the past 24 hours"
              },
              "end_time": {
                "data_type": "numeric",
                "order": 2,
                "description": "End of time range, in epoch time (milliseconds)",
                "verbose": "If not specified, the default is now"
              },
              "container_count": {
                "data_type": "numeric",
                "order": 3,
                "description": "Maximum number of container records to query for."
              },
              "artifact_count": {
                "data_type": "numeric",
                "order": 4,
                "description": "Maximum number of artifact records to query for."
              }
            },
            "output": [],
            "versions":"EQ(*)"
          }
    ]
}